---
title: >
  Modeling the impacts of park access on health outcomes: a utility-based 
  accessibility approach
runninghead: Macfarlane \emph{et al}.
author:
  - name: Gregory Macfarlane
    num: 1
  - name: Nico Boyd
    num: 2
  - name: John E. Taylor
    num: 3
  - name: Kari Watkins
    num: 3
address:
  - code: 1
    address: Civil and Environmental Engineering Department, Brigham Young University 
  - code: 2
    address: Fehr and Peers, Los Angeles, California
  - code: 3
    address: School of Civil and Environmental Engineering, Georgia Institute of Technology
corrauth: "Gregory Macfarlane, 430 Engineering Building, Provo UT 84663"
email: gregmacfarlane@gmail.com
abstract: >
  Recent research has underscored the potential for public green spaces to influence individual and societal health outcomes, but empirical measurements of such influences have yielded mixed results to date, with particular disagreement surrounding how access to parks ought to be defined while controlling for alternate explanations. In this paper we apply a comprehensive measure of park accessibility drawn from random utility choice theory, which avoids arbitrary assertions of proximity while incorporating potentially numerous amenities and attributes of both the parks and the population. We apply this utility-based accessibility measure to correlate Census tract-level obesity and physical activity rate estimates from the Centers for Disease Control and Prevention's 500 Cities project with tract-level American Community Survey socioeconomic data in New York City, paired with geographic open space data from New York City. Controlling for the socioeconomic variables and spatially correlated error terms, we show a positive and significant relationship between park access and physical activity rates. The data also suggest a negative relationship between park access and obesity rates, beyond what is expected through physical activity and socioeconomics. In doing so, this research contributes a more comprehensive modeling approach for measuring the impact of park access on health, and may improve our understanding of the role  parks and access to them can serve in furthering public health objectives.
keywords: Accessibility; Green Space
classoption:
  - shortAfour
output: 
  rticles::sage_article:
    keep_md: yes
    keep_tex: yes
    includes: 
      in_header: preamble.tex
      after_body: appendix.tex
bibliography: library.bib
bibliographystyle: sageh.bst
---

```{r setup, cache = FALSE, echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(broom)
library(geojsonio)
library(rgdal)
library(rgeos)
library(maptools)
library(spdep)
library(sf)
library(VGAM)
library(qwraps2)
library(knitr)
library(kableExtra)
library(texreg)
library(here)
library(xtable)

options(tigris_use_cache = TRUE)
opts_chunk$set(cache=FALSE, message = FALSE, echo = FALSE, warning = FALSE)
library(leaflet)

knit_hooks$set(inline = function(x) {
  prettyNum(x, big.mark=",", digits = 4, drop0trailing = TRUE)
})


```

# Introduction

The United States and other developed nations face an epidemic of obesity and
chronic diseases, including cardiovascular diseases, chronic respiratory
diseases, diabetes, stroke, joint and bone diseases, and cancer. These diseases
can severely limit the lifespan of affected individuals [@WHO2014], with 
substantial financial costs for treatment borne both privately and socially
[@Finkelstein2009]. Though a moderate amount of regular physical activity
has been established as an effective strategy for reducing and managing obesity
and many of the aforementioned chronic diseases [@CDC2009; @Durstine2013],
a large portion of U.S. adults do not participate in sufficient physical
activity [@Wolf2008].

Historically, most large-scale health promotion efforts focused on
individual-level interventions intended to educate people about healthy
lifestyles and behaviors, touching on topics including diet and exercise.
Over the last several years a new *social* model of health has evolved,
described by @Duhl1999 
``as an outcome of the effects of socioeconomic status, culture,
environmental conditions, housing, employment and community influences''[-@Duhl1999, p.7].
In this new paradigm, resources provided via civil infrastructure --- in
particular parks and other public green spaces --- play a crucial role in
promoting and sustaining public health [@Bedimo-Rung2005; @Wells2007; @Coutts2008].
After all, it does little to educate individuals on the importance of exercise
if their community is designed and built in such a way that such exercise is
expensive, unenjoyable, or unsafe. It is similarly necessary for urban planners
to identify which neighborhoods have access to quality green space, and which
neighborhoods need intervention in the form of new or rehabilitated green space,
or improved transportation access to existing quality green space.

But in spite of the potential for green spaces to influence public health outcomes 
and numerous studies attempting to empirically estimate the strength of these
outcomes, evidence to date has been mixed. A major challenge researchers have
faced is a proliferation of techniques for measuring access to green spaces, of
which many are plausible but lack robust theoretical bases. 

In this paper, we apply a holistic and flexible measurement for park
accessibility based in activity location choice theory. This utility-based
accessibility measure compares the continuous distance to all parks in the
region, weighted against the sizes of each park and its other assorted
amenities. We apply this measure to study the link between park accessibility
and attractiveness and census tract-level aggregate physical activity
participation and obesity rates in New York City, controlling for spatially
correlated unobserved effects, spatial spillovers of covariates, and tract-level
socioeconomic characteristics. We also demonstrate how the utility-based
accessibility metric can potentially be expanded to account for other measures
of a park's attractiveness in the form of various park amenities. The paper
concludes with a discussion of opportunities for future research.

# Literature Review 
\label{sec:litreview}
The question of how green space in the urban environment affects the physical,
emotional, and mental well-being of urban residents is not new to the academic
literature. Comprehensive reviews and analysis of this literature up to 2007
can be had from @tzoulas2007promoting, and for the subsequent decade from
@kabisch2015human. In spite of the depth of this research arena --- or perhaps
because of it --- quantitative approaches for assessing both health outcomes and
access to green space vary widely. It is therefore not surprising that in a
meta-analysis of 20 recent peer reviewed journal articles exploring the
relationship between access to parks and objectively measured physical activity,
@Bancroft2015 found that five studies reported a significant positive
association, six studies produced mixed results, and nine studies found no
association at all.

Loosely defined, the *accessibility* of an arbitrary place describes the ease
with which people can accomplish activities there.  Accessibility is an abstract
concept with tempting quantifiability [@Handy1997], but objective quantification 
may not be strictly necessary. For example, takano2002urban showed improved 
survival rates among senior citizens in Japan who self-reported having access
to qualitatively good walking spaces. Though encouraging, this result could
simply reveal self-selection: Those seniors who felt the walking space was good
were those who chose to enjoy it. Urban planners seeking to evaluate which
residents have good access to quality green space may desire objective and
therefore comparable measures.

@Dong2006 present a helpful mathematical heirarchy of
common quantitative mechanisms for calculating access, which we follow here.
Consider a person residing at
point $i$ in a city with parks $j \in 1 \ldots J$. An analyst might consider
point $i$ as "having access" to a park if the distance to the park $d_{ij}$ is 
within an "isochrone," or a geometric buffer defined by some threshold $D$,

\begin{equation}\label{eq:isochrone}
A_i = \begin{cases} 
      1 & d_{ij}\leq D\\
      0 & d_{ij} > D
   \end{cases}
\end{equation}

Applications of this isochrone-based framework are easily derived and relatively
common. 
ParkScore [@parkscore2019] is a sophisticated application of this approach where $D$ is a
carefully calculated 10-minute network-bound walk, paired with a demographic analysis of
areas within and outside of this threshold. @devries2003natural
showed the amount of greenspace within a 3-kilometer radius was positively associated
with a suite of self-reported health outcomes. Similarly, @devries2013streetscape
showed that streetscape greenery within 500 meters of a residence was associated with
perceived general health. Conversely, @carlson2012interactions found no relationship
between the health of senior citizens and the number of parks within 500 meters.

Another common access measure fits in this category, where distance-based
isochrones are replaced with political, geographical, or statistical boundaries.
These are especially common in comparative macroscopic studies, such as the
positive relationships found by @West2012 between density of park land in a
metropolitan area and self-reported population health indicators derived from
the Behavioral Risk Factor Surveillance System (BRFSS). On the other hand,
@Larson2016 found no relationship between physical health and park
quantity, quality, and accessibility in 44 U.S. cities and self-reported scores
on the Gallup-Healthways Wellbeing Index. At the sub-metropolitan level, 
the @Stark2014 found a significant relationship in New York City between the percent
of a residential ZIP code that is park space and objectively measured body
mass index (BMI). It is also possible to attenuate an isochrone with 
various factors; for instance, @Dias2019 considered road safety perception as an
extenuating factor in the effective distance to a park.

In spite of the flexibility of adapted isochrone techniques, the arbritrary
definitions necessarily imposed by researchers in its application can inhibit
holistic analysis [@Logan2017].
A somewhat more complete approach is the so-called "gravity" accessibility
statistic. In this case the accessibility of point $i$ is the denominator of the
gravity formulation of a trip distribution model,
\begin{equation}\label{eq:gravity}
A_i = \sum_{j = 1}^J S_j f(d_{ij})
\end{equation}
where $S_j$ is the "size" of each park literally (i.e. acres) or abstractly (i.e.
trip attractions) and $f(d_{ij})$ is a monotonically decreasing cost function,
usually a negative exponential. @Dong2006 note that the isochrone framework is a
special case of the gravity model where $f(d_{ij})$ is a binary function and
$S_j = 1$.
@Giles-Corti2005 compare various gravity-based accessibility scores with an
isochrone specification and show that the former are more predictive of walking
behavior; that is, the attributes of a park influence walking more than
merely the distance to it. @hillsdon2006relationship found no relationship between
a gravity-based accessibility term and self-reported physical activity among middle-aged individuals in Norwich, England. @Zhang2011 developed a population-weighted,
gravity-based accessibility to parks metric with a national scope, though they
do not examine its correlation with health outcomes.

A third accessibility mechanism is a utility-based specification, termed as such
for being derived from random utility choice theory. Consider that an individual
living at point $i$ is choosing a park for a recreation activity. If we apply
the multinomial logit model [@McFadden1974], the expected consumer surplus
enjoyed by this individual can be shown to be
\begin{equation}\label{eq:utility}
A_i = \ln\left({\sum_{j = 1}^J\exp(V_{ij})}\right) + C
\end{equation}
where parks are differentiated from each other by their relative measurable
*utilities*, $V_{ij}$. $C$ is an unknown constant, but the difference in consumer
surplus between two points $i$ and $k$ can be quantitatively compared as 
$A_i - A_k$ [@Bruce1977]. In principle, $V$ may include any measurable attributes of either
the choice maker or the park, and is typically represented as a linear-in-parameters
function of destination attributes $X_j$ and the travel cost $d_{ij}$,
\begin{equation}\label{eq:utilityV}
V_{ij} = X_j\boldsymbol{\beta} + \beta_d * d_{ij}
\end{equation}
The coefficients $\boldsymbol{\beta}$ are frequently estimated from household
surveys, though in the absence of a survey we may assert reasonable values.

Note that the gravity formulation is itself a special case of the utility-based
specification where $\exp(X_j\boldsymbol{\beta} + \beta_d d_{ij}) = X_j f(d_{ij})$
[@Daly1982]. The distinction between gravity and utility-based specification is
meaningful, however. Primarily, it becomes possible to construct accessibility
statistics based on revealed behavioral preferences rather than calibrated or
asserted values [@Handy1997]. @Kinnell2006 collected a choice-based survey 
sufficient to construct a utility-based measure, though they do not do so.
Similarly, @Kaczynski2016 present what is effectively a utility-based score called
"ParkIndex", with the explicit motivation of developing a uniformly applicable
park accessibility statistic, though they limit this statistic as a way to add
heterogeneity within an isochrone analysis. 

Both gravity and utility-based specifications hold several advantages relative
to isochrone-based accessibility metrics more commonly found in the literature.
First, all individuals are defined as having some access to all parks, rather
than an arbitrary cutoff asserted by the researcher. This allows for the fact
that some people are more or less sensitive to distances, and that distance is a
continuous, non-binary phenomenon. It defies reason to assume a person living
11 minutes via walking from a park always has meaningfully different
accessibility than someone living 9 minutes away. Second, the random utility
formulation allows the
researcher to include -- in principle -- any attribute of the park as part of
its utility specification. This suggests that not all parks are equal, and that
a large park with many amenities such as Central Park in Manhattan may provide
health and activity benefits over a much larger area than a smaller community
square.

In spite of its flexibility and basis in choice theory, utility-based
accessibility measures have not received much application in the accessibility
literature compared with distance-based or even gravity-based measures.
@Vale2016 present a descriptive classification of active accessibility techniques, and
explicitly dismiss utility-based metrics for incorporating randomness. The
accessibility formula presented in Equation \ref{eq:utility} is the expectation of a
random utility process, and is not in and of itself random any more than the
gravity model is random.
Utility-based accessibility metrics are commonly used, however, in alternatives
analyses of transit infrastructure improvements [@DeJong2007]. A reason for this
is likely that a regional travel demand model is available to the analysts, thus
making calibrated and multimodal logsums readily available [@Geurs2010].

# Empirical Application
In this section, we develop a model with data for New York City, where
we compute a set of utility-based accessibility to parks scores for each tract
and model the relationship between this measure and physical activity rates,
controlling for spatial effects and socioeconomic factors. We subsequently model
the effect of the accessibility metric on obesity rates, accounting for physical
activity and the other controls.

## Data

```{r tracts}
# built in 01_health_data.Rmd and 04_accessibility.Rmd
tracts <- est_data <- read_rds(here("data/tracts.rds")) %>%
  left_join(read_rds(here("data/tract_logsums.rds")), by = "geoid") %>%
  left_join(read_rds(here("data/walk10.rds")), by = "geoid")
```

This study uses data available to the public from a variety of federal and state
data agencies^[The datasets, as well as the analysis code, are available on GitHub
at \url{https://github.com/gregmacfarlane/parks_access}.].
The Centers for Disease Control and Prevention makes small-area estimates on
key health indicators available through its 500 Cities data program [@CDC5002016].
The indicators are multilevel aggregations and imputations of BRFSS responses
[@Wang2018; @Wang2017], and have been recently used to study the tract-level
link between gentrification and urban health [@Gibbons2018]. We use two
indicators as our dependent variables in this study: the share of adults
in a Census tract who are obese, and the share of adults who participate in no
leisure-time physical activity. To improve clarity in our interpretation, we use
the complement of the second variable --- the share of tract adults who
participate in *some* physical activity --- even if the amount may not be
sufficient to affect overall health. Both indicators are obtained for the year
2016.

To the health data, we join socioeconomic data collected through the Census
Bureau API via the \texttt{tidycensus} package for R [@Walker2019]. The
primary dataset is a geographic polygons layer of Census tracts in the five
boroughs of New York City. We append to each Census tract relevant
socioeconomic data for each tract from the American Community Survey
2013-2017 5-year estimates. For a small handful of tracts in our sample, Census
supressed the median income estimate; these appear to be primarily wealthy
tracts and in almost all cases the CDC estimates of obesity and physical
activity are missing as well. After removing these tracts from the estimation
dataset, we have `r nrow(tracts)` complete cases. Table \ref{tab:tractsdata}
presents key descriptive statistics for these data.

```{r parks}
# This data is created in 02_parks_data.Rmd
parks <- read_rds(here("data/open_spaces.rds"))
```

In a destination choice framework, the tracts represent the "origins" and the
"destinations" are parks and green spaces in New York City.
We retrieved a polygons layer of public parks and greenspaces within New York City’s
municipal boundaries and checked it for accuracy and relevance [@nycparks].
Upon inspection, we removed several facilities that do not qualify as
publicly accessible green space, such as Yankee Stadium, Citi Field, and their
surrounding parking lots. We also removed parks of less than half an acre in
size, as these appear to be predominantly planted medians rather than legitimate
public green space. We consolidated individual geographic polygons
comprising a single facility --- as is the case in Flushing Meadows --- and
eliminated sub-facilities such as tennis courts or baseball fields included within
larger park facilities. Instead of these distinct sub-facilities, we created 
variables for each containing park indicating the presence of sports courts,
playgrounds, and trails.

To this dataset of parks and regularized green spaces, we add a polygons layer of
cemeteries in New York that are open to the public. Cemeteries are important
green spaces that can be used for many types of physical activity. These
operations leave us with `r nrow(parks)` distinct green spaces; for simplicity 
we will refer to both parks and cemeteries as "parks" going forward. 
For each park, we calculate the size of the park in acres. 

```{r tractsdata, results="asis", message=FALSE, warning=FALSE, cache=FALSE}
# This is an index pairing the variable names with the order we want them
# to be shown in in the table.
tracts_data_index <- tibble(
  variable =  c(
    "obesity", "physact", "income",
    "density", "fulltime", "college", "single",
    "youth", "young_adults",  "seniors", "black", "asian", "hispanic",
    "other"),
  source = c("CDC 500 Cities", "CDC 500 Cities",
             rep("ACS", 12))
) %>%
  mutate(order = row_number())

# Get the tract SE / health data, calculate group statistics, and get it
# in the right order
tract_summary <- tracts %>%
  st_set_geometry(NULL) %>%
  tbl_df() %>%
  dplyr::select(tracts_data_index$variable) %>%
  gather(variable, value) %>%
  group_by(variable) %>%
  summarise(
    min = min(value),
    `msd` = paste(median_iqr(value)),
    max = max(value)
  ) %>%
  inner_join(tracts_data_index) %>%
  arrange(order) %>%
  mutate(
    variable = c(
      "Obesity: Share of adults over 18 who are obese",
      "Physical Activity: Share of adults over 18 who engage in some leisure-time physical activity",
      "Income: Median tract income",
      "Density: Households per square kilometer",
      "Fulltime: Share of adults over 18 with full-time work",
      "College: Share of adults over 24 with a college degree",
      "Single: Share of adults over 18 living alone or in a non-partnership household",
      "Youth: Share of population under 18",
      "Young adults: Share of population between 18 and 34",
      "Seniors: Share of population who are 65 and over",
      "Black: Share of population who is black",
      "Asian: Share of population who is Asian",
      "Hispanic: Share of population who is Hispanic",
      "Other: Share of population who belong to other minority groups")
  ) %>%
  dplyr::select(-order)

tract_rows <- nrow(tract_summary)

park_summary <- parks %>%
  st_set_geometry(NULL) %>%
  dplyr::select(acres, courts, playgrounds, trails) %>% 
  gather(variable, value) %>%
  group_by(variable) %>%
  summarise(
    min = min(value),
    `msd` = paste(median_iqr(value)),
    max = max(value)
  ) %>%
  mutate(
    variable = c("Size: Park size in acres",
                 "Courts: Presence of sport courts / ball fields",
                 "Playgrounds: Presence of playgrounds",
                 "Trails: Presence of trails"),
    source = c(rep("NYC", 4))
  )

bind_rows(tract_summary, park_summary) %>%
  separate(variable, c("var", "desc"), sep = ": ") %>%
  mutate(
    msd = str_replace(msd, " \\(", "\\\\\\\\ \\("),
    msd = str_c("\\makecell{", msd, "}")
  ) %>%
  kable(escape = FALSE, digits = 2, format = "latex",
        table.envir = "table*", booktabs = TRUE,
        caption = "Descriptive Statistics of Tract and Park Variables",
        col.names = c(" ", "Description", "Minimum", "Median (IQR)", "Maximum", "Source")) %>%
  kable_styling(latex_options = "scale_down") %>%
  column_spec(2, width = "2in") %>%
  group_rows(paste("Tract Variables, N =", nrow(tracts)), 1, tract_rows) %>%
  group_rows(paste("Park Variables, N =", nrow(parks)), tract_rows + 1, tract_rows + nrow(park_summary))
```


## Accessibility 
\label{subsec:accessibility}

We calculate a pair of utility-based accessibility statistics for each tract
in New York City. The most basic utility specification includes only the
park size in acres and the Euclidean distance from the population-weighted tract
centroid to the nearest boundary of the park in miles,
\begin{equation}\label{eq:u_access}
V_{ij} = \lambda_s * \log(size_j) + \lambda_d * \log(distance_{ij})
\end{equation}
There are a few cases where the population-weighted tract centroid lies on or
within the boundary of a park; for these cases we assert that the minimum
possible distance is one tenth of a mile.
The logarithmic transform allows for diminishing marginal utility of distance
and park size: A 1-mile increase to a trip matters more for a 1-mile trip than a
10-mile trip. @Macfarlane2019 estimated destination choice 
parameters for park trips in Alameda County (Oakland), California by applying
this utility specification to passively collected mobile device data, obtaining values of $\lambda_s = 0.373$ and 
$\lambda_d = -1.76$. The ratio of these estimates implies people are willing to
travel roughly six times further to reach a park twice as large. We do not have
access to the necessary data to repeat the @Macfarlane2019 methodology in New
York, and the public parks datasets in Alameda County are
not sufficiently detailed to perform the present accessibility analysis there.
In the absence of park trip destination choice coefficients in New York City, we
adopt these previous estimates.

@Kinnell2006 surveyed park users in New Jersey and applied a multinomial logit
model to determine which factors influence a park's perceived utility as a park
trip destination. By transferring estimates of common variables between our
data and this survey-based model, we can create a second utility specification
as
\begin{equation}\label{eq:u_multi}
\begin{split}
V_{ij} & = \lambda_s * \log(size_j) + \lambda_d * \log(distance_{ij}) + \\ 
  & \quad \lambda_t * trails + \lambda_{c} * courts + \lambda_p * playgrounds
\end{split}
\end{equation}
with $\lambda_t = 0.99$, $\lambda_c = 0.43$, and $\lambda_p = 0.26$. Kinnell et
al. did not transform their size and distance estimates, so we retain the
previously estimated and applied values. We assume that the other covariates in
the model which we do not have available to us (e.g., boat launches, picnic
areas) are orthogonal to the included parameters and leaving them out will not
affect the values of the included coefficients.

We then calculate the utility-based accessibility of each tract $A_i$ as defined
in Equation \ref{eq:utility} under each utility specification. Recall that the 
total value of the accessibility is relative to an unknown scalar $C$; for this 
reason we standardize the accessibility values for all tracts within each
utility specification, 
\begin{equation}\label{eq:v_logged}
A_i' = \frac{A_i - \bar{\boldsymbol{A}}}
            {\sigma_{\boldsymbol{A}}}
\end{equation}

Figure \ref{fig:map} shows a map of New York City with each tract highlighted
based on its relative size and distance utility-based accessibility score (Equation
\ref{eq:u_access}). The most continuous region of good park access is in upper
Manhattan and the Bronx, bracketed by Central Park and the Bronx River.
Conversely, some of the poorest-accessibility areas are in Brooklyn tracts not
immediately adjacent to Prospect Park. Because the accessibility statistic is
normalized, the worst values are slightly below $-3$, the best somewhere above
$3$.

For comparative purposes, we also employ an isochrone analysis using the
10-minute walk threshold calculated for ParkScore [@parkscore2019]. If the
population-weighted centroid of a tract is within a 10-minute walk of a green space
as defined by ParkScore, the tract is considered as having "access" to a park.
The centroid is necessary as all tracts in New York City have at least *some* 
intersection with the 10-minute walk buffer; as it is, only 
`r sum(!tracts$walk10)` of the `r nrow(tracts)` tract centroids are not located 
within this buffer.

```{r map, fig.env="figure*", echo=FALSE, message=FALSE, warning=FALSE, fig.height=4, fig.cap="Normalized utility-based park accessibility values in New York City."}
library(ggmap)
map <- ggmap(
  get_stamenmap(unname(st_bbox(tracts)), 
                maptype = "toner-lite"), extent = "device")
map +
  geom_sf(data = tracts, inherit.aes=FALSE,
          aes(fill = cut(euc_multi, breaks = c(-Inf, -3, -2, -1, 0, 1, 2, 3, Inf))),
          alpha = 0.9, color = NA) +
  scale_fill_brewer("Accessibility", palette = "RdYlBu")
```


## Model 
\label{subsec:model}

We predict either the physical activity or the obesity rate ($y$) in a census
tract as a linear function of the tract's sociodemographic characteristics $X$
and accessibility to parks $\boldsymbol{A}$,
\begin{equation}\label{eq:themodel}
 \boldsymbol{y} = X\boldsymbol{\beta} + \beta_{a}\boldsymbol{A} + \boldsymbol{\varepsilon}
\end{equation}
where $X$ is a matrix of dimension $n\times p$ where $n$ is the number of observations and $p$ is the number of predictor
variables, and $\boldsymbol{\beta}$ is a $p\times 1$ vector of estimated parameters.
The accessibility vector $\boldsymbol{A}$ influences physical activity or obesity rates by the
single estimated parameter $\beta_a$, and a vector $\boldsymbol{\varepsilon}$ 
represents the model residual as a random variable.

As the observations are related to each other spatially, it is likely that this
process involves spatial spillovers of one kind or another. A complete treatment of
spatial econometrics is not warranted here; the reader is directed to
@LeSage2009 as well as @LeSage2014.
Suffice it to say that the presence of spatial data generating processes can
negatively affect econometric interpretation in a variety of ways. Each of these
processes rely on spatial autoregression, where elements of some random
variable $x$ are spatially dependent on other elements, 
\begin{equation}\label{eq:autoregression}
 \boldsymbol{x} = \rho W \boldsymbol{x} + \boldsymbol{\varepsilon}
\end{equation}
with the strength of dependence an estimated parameter $\rho$, the structure of 
spatial dependence governed by the asserted matrix $W$ (details of $W$ follow below),
and some random uncorrelated residual $\varepsilon$. A collection of models is
available to represent spatial autodependence in the model residuals, the 
independent variables, and the dependent variable.

The specific spatial model applied is both an econometric choice --- as
improperly specified spatial models can lead to inconsistent estimates of model
parameters and standard errors --- as well as a philosophical choice about the
likely structure of spillovers in the problem at hand. In case of physical
activity and obesity rates, we believe that the outcomes are locally dependent:
That is, a particular individual decides whether or not to participate in
physical activity independently of whether his or her neighbors participate in
physical activity. This does not mean that we think it impossible that the
socioeconomic variables of neighboring tracts do not play a role.
Mathematically, we assert that the autodependence relationship on the dependent
variable $\boldsymbol{y} = \rho W \boldsymbol{y} + \ldots$ has $\rho = 0$ in the
current case.

With this relationship ruled out, it remains a possibility that the model
residuals are spatially dependent,
\begin{equation}\label{eq:SEM}
 \boldsymbol{y} = X\boldsymbol{\beta} + \beta_a \boldsymbol{A} + \boldsymbol{u}; \boldsymbol{u} = \lambda W \boldsymbol{u} + \boldsymbol{\varepsilon}
\end{equation}
that the outcome is partially dependent on the socioeconomic variables in *neighboring*
tracts,
\begin{equation}\label{eq:SLX}
 \boldsymbol{y} = X\boldsymbol{\beta} + \beta_a \boldsymbol{A} + W X \boldsymbol{\gamma} + \boldsymbol{\varepsilon}
\end{equation}
or a linear combination of both.
\begin{equation}\label{eq:SDEM}
 \boldsymbol{y} = X\boldsymbol{\beta} + \beta_a \boldsymbol{A} + W X \boldsymbol{\gamma} + \boldsymbol{u}; \boldsymbol{u} = \lambda W \boldsymbol{u} + \boldsymbol{\varepsilon}
\end{equation}
These models are referred as the spatial error model (SEM), the spatial lag of
$X$ model (SLX), and the spatial Durbin error model (SDEM). @Pace2008 suggest
that a Hausman-style test of the estimates of $\boldsymbol{\beta}$ derived from the OLS 
(Equation \ref{eq:themodel}) and SEM (Equation \ref{eq:SEM}) can identify whether
the estimates are consistent. If the $\boldsymbol{\beta}$ estimates are dissimilar, both 
specifications are inappropriate as they contain untreated omitted variables.
Similarly, if the SLX and SDEM estimates are dissimilar it is an indication of 
missing variables in that specification. On the other hand if the estimates of
both pairs of models are similar and the residual correlation parameter $\lambda$
is non-zero, the model accounting for spatially dependent residuals will produce 
proper estimates of the model standard errors.

Note that in the lag-$X$ specifications (SLX and SDEM) we exclude the accessiblity 
component $\boldsymbol{A}$, that is we do *not* consider that the accessibility
in a neighboring zone will have an effect on physical activity or obesity rates.
In a practical sense, this is because the accessibility term $\boldsymbol{A}$ is itself spatially
determined.


### Spatial Weights

The spatial weights matrix $W$ is constructed of individual elements where
$w_{ij} = 0$ if observations $i$ and $j$ are spatially independent of each other,
and $w_{ij} > 0$ if $i$ and $j$ are spatially related in some way. 
@Dubin1998 presents details on constructing $W$, but in this study we
assume that tracts sharing at least one common border point are neighbors of
each other^[We also considered a distance-discounted weights matrix, which
produced similar results. This matrix is selected for simplicity.]. The elements
of $W$ are then row-standardized so that each observation has an equal total
influence from all its neighbors.

```{r weights, warning = FALSE}
W <- read_rds(here("data/Wtr.rds"))
trMC <- trW(as(W, "CsparseMatrix"), type="MC")
```


## Results

```{r results}
slx_vs_sdem <- read_rds(here("data/slx_vs_sdem.rds"))
pa_models <- read_rds(here("data/pa_models.rds"))
obesity_models <- read_rds(here("data/obesity_models.rds"))
```


```{r termnames}
base_termnames <- c(
  "(Intercept)", "log(Density)", "log(Income)", "Fulltime", "College-educated",  "Single Adults",
  "Youth (0-17)", "Young adults (18-34)", "Seniors (65+)", "Black population share",
  "Asian population share", "Hispanic population share", "Other Minorities"
)

termnames <- c(
  base_termnames, str_c("$\\gamma$: ", base_termnames[-1]), 
  "Accessibility", "$\\lambda$: spatial correlation"
)

#coefficient map
cm <- as.list(termnames)
names(cm) <- c(names(slx_vs_sdem$SDEM$coefficients), "$\\lambda$")
```

```{r slx_hausman}
slx_hausman <- function(slx, sdem) {
  b1 <- slx$coefficients
  b2 <- sdem$coefficients
  db <- b1 - b2
  
  V1 <- vcov(slx)[names(b1), names(b1) ]
  V2 <- vcov(sdem)[names(b2), names(b2) ]
  dV <- V2 - V1
  
  tibble(
    Hstat = t(db) %*% MASS::ginv(dV) %*% db, 
    "p-value" = pchisq(Hstat, df = Matrix::rankMatrix(dV), lower.tail = FALSE)
  )
}

slx_sdem_htest <- slx_hausman(slx_vs_sdem[[1]], slx_vs_sdem[[2]])
```

To determine which spatial effects specification was appropriate, we estimated
SLX and SDEM models of physical activity participation rates as a function of
tract covariates and  accessibility. These two models are presented in Table 
\ref{tab:slx-sdem}. With only a few exceptions, the SLX and SDEM coefficient
estimates for corresponding covariates lie within the 95\% confidence intervals
of the other model. A Hausman-style test [@Pace2008] on the coefficients 
assumes a null hypothesis that the coefficients are equivalent; this test 
produces $p$-value of only $`r slx_sdem_htest[2]`$. Though this statistic is
well beneath a common hypothesis test threshold of $\alpha = 0.05$, we
elect retain the null hypothesis that the coefficients are equivalent, as 
the differences are at no point practically different from each other. The consequences
of rejecting the null hypothesis in this case would be to suggest a model with 
spatial dependence of the dependent variable; as stated above, we feel that such
a relationship is unreasonable. As a consequence of these analyses, we adopt the
SDEM specification moving forward as the spatial lag of the errors is 
significant and the overal log likelihood of the SDEM is higher than the SLX 
specification.

\begin{table*}
\caption{Comparison of SLX and SDEM Coefficients}
\label{tab:slx-sdem}
\begin{tabular}{l d{2.4} d{2.4} d{2.4} c d{2.4} d{2.4} d{2.4} }
\toprule
 & \multicolumn{3}{c}{SLX} & & \multicolumn{3}{c}{SDEM} \\
\cmidrule{2-4}\cmidrule{6-8}
 & \multicolumn{1}{c}{Estimate} & \multicolumn{2}{c}{95\% Conf.Int.} & 
 & \multicolumn{1}{c}{Estimate} & \multicolumn{2}{c}{95\% Conf.Int.}\\
\midrule
```{r slx-sdem, results = "asis"}
slx_coefs <- lapply(slx_vs_sdem, function(x) tidy(x, conf.int = TRUE))
slx_stats <- lapply(slx_vs_sdem, glance)
tab <- right_join(slx_coefs$SLX, slx_coefs$SDEM, by = "term") %>%
  transmute(term, estimate.x, conf.low.x, conf.high.x, space = " ",
                  estimate.y, conf.low.y, conf.high.y) %>%
  mutate(term = unlist(cm))

xtab <- xtable(tab, digits = 4)
print(xtab, include.rownames = FALSE, include.colnames = F,
      sanitize.text.function = identity, floating = F, only.contents = T, hline.after = NULL)
```
\midrule
Log Likelihood & \multicolumn{3}{c}{$-4831.974$} & & \multicolumn{3}{c}{$-4435.507$}\\
Num.Obs.       & \multicolumn{3}{c}{$2099$}   & & \multicolumn{3}{c}{$2099$}\\
\bottomrule
\end{tabular}
\end{table*}

The coefficients in the SDEM model are of two general types: the direct effect
resulting from a tract's own attributes and the indirect effect ($\boldsymbol{\gamma}$)
resulting from the spatially-weighted attributes of its neighbors. For example, a
percentage point increase in the share of young adults in a tract increases the
expected physical activity rate in a tract by 
`r slx_vs_sdem[[2]]$coefficients["young_adults"]` percentage points, and a
percentage point increase in the share of young adults
*in neighboring tracts* increases the expected physical activity rate by an 
*additional* `r slx_vs_sdem[[2]]$coefficients["lag.young_adults"]` percentage
points. This opportunity to examine spatial spillovers of attributes is a key 
benefit of using a spatial model.

For the most part the direct coefficients are highly significant and of the
expected sign. Tracts with higher shares of full-time workers, college-educated
adults, young adults, and high-income households all show a greater share of
individuals engaging in regular physical activity. Conversely, tracts with
greater population density and a greater share of single adults, children,
seniors, minorities, and low income households all have lower modeled expected
rates of physical activity. The indirect coefficients are less clearly significant,
with only density, median tract income, some age groups, and some minority groups
showing an indirect effect.

Table \ref{tab:pa-models} presents the estimated spatial lag and accessibility
coefficients for three models using different specifications of the utility
equation, as well as the ten-minute walk buffer calculated by ParkScore. 
Note that the model called "Size and Distance" is precisely the model
labeled "SDEM" in Table \ref{tab:slx-sdem}. The controlling covariates are
suppressed for clarity but do not change meaningfully across the four specifications.
Complete model estimates are available in the Appendix. Each of the three
utility-based specifications is significant at the $\alpha = 0.05$ level or lower,
and is of the hypothesized directionality. That is, residents living in tracts 
with increased utility-based accessiblity to green spaces show a significantly
higher physical activity participation rate. Taking the rough mean of the 2
estimated utility-based coefficients, moving from the least-accessible tract
($A_i = -3$) to the
most-accessible tract ($A_i = 3$) is expected to raise the physical activity rate
by `r 6 * .15` percentage points. With the understanding of the full 95\% confidence
interval, we could suggest that the true effect of excellent versus poor park access
is anywhere between `r 6 * .01` and `r 6 * .3` percentage points.

The 10-minute walk buffer is considerably less useful at isolating the effects
of park "access" on physical activity rates. As so few tracts are located
outside of the buffer, the standard error of the estimated effect is large and implies
an effect on activity rates anywhere from a loss of `r 6 * .18` percentage points
to a gain of `r 6 * 1.35`.

\begin{table*}
\caption{Estimated Effect of Accessibility on Physical Activity Rates}
\label{tab:pa-models}
```{r pa-models, results = "asis"}
texreg(pa_models[c(2:4)], digits = 4, ci.force = TRUE,
       booktabs = TRUE, use.packages = FALSE, 
       custom.model.names = c("Size and Distance", "Amenities", "10-Minute Walk"),
       custom.coef.map = list(
         "lambda" = "$\\lambda$: spatial correlation", 
         "euc_access" = "Accessibility", 
         "euc_multi" = "Accessibility", 
         "walk10TRUE" = "Accessibility"),
       caption = "Estimated Effect of Accessibility on Physical Activity Rates",
       label = "tab:pa-models", table = FALSE,
       caption.above = TRUE, include.aic = F, include.lr = F,
       custom.note = "%stars 95\\% confidence interval in brackets.  $y = $ tract-level physical activity rate.")
```
\end{table*}

We now consider the impacts of a model where the dependent variable is
the *obesity* rate in a tract, and physical activity becomes an independent covariate
alongside the controlling variables and the accessibility metrics.
Table \ref{tab:obesity-models} presents estimates of the effect of all three
utility-based accessibility measures as well as the 10-minute walk buffer. 
As before, the estimates of the other variables are available in the Appendix.
The correlation between physical activity rates and obesity is clear; for every
percentage point increase in physical activity rate, the expected obesity rate
drops by $0.43$ percentage points in all four accessiblity specifications.
The indirect effect of physical activity rates on obesity in neighboring zones
is inconsequential, supporting our methodological assertion that public health
variables are not spatially dependent, though the factors leading to them may be.

As far as the accessibility values are concerned, none of the three
utility-based specifications nor the ParkScore 10-minute walk buffer are
correlated with obesity rates at the traditional 95\% confidence interval. 
It is important to consider the implications of the full range of the confidence
interval, however [@Amrhein2019]. The results suggest that after controlling
for tract socioeconomic variables, physical activity rates, and spatially correlated
error terms, obesity rates in tracts with excellent park accessibility are expected 
to be between `r 6 * 0.12` percentage points lower and `r 6 * .035` percentage 
points higher than tracts with poor park accessibility. This range of values 
suggests that accessibility to parks may have obesity-reducing effects beyond
the effect of accessibility on physical activity rates worth further study.

\begin{table*}
\caption{Estimated Effect of Accessibility on Obesity Rates}
\label{tab:obesity-models}
```{r obesity-models, results="asis"}
texreg(obesity_models[c(2:4)], digits = 4, ci.force = TRUE, 
       booktabs = TRUE, use.packages = FALSE, 
       custom.model.names = c("Size and Distance", "Amenities", "10-Minute Walk"),
       custom.coef.map = list(
         "physact" = "Physical Activity", 
         "lag.physact" = "$\\gamma$: Physical Activity",
         "lambda" = "$\\lambda$: spatial correlation", 
         "euc_access" = "Accessibility", 
         "euc_multi" = "Accessibility", 
         "walk10TRUE" = "Accessibility"),
       caption = "Estimated Effect of Accessibility on Obesity Rates",
       label = "tab:obesity-models", table = FALSE,
       caption.above = TRUE, include.aic = F, include.lr = F,
       custom.note = "%stars 95\\% confidence interval in brackets.  $y = $ tract-level obesity rate.")
```
\end{table*}

# Limitations and Future Research Direction

We readily acknowledge limitations in this study. As in any study conducted
with areal data, we are at risk of falling victim to the ecological inference
fallacy, where aggregate statistics mask or contradict disaggregated or
individual-level trends. The socioeconomic and public health data used in this
study are only available at the tract level; projecting the tract-level data to the block
group level and computing more spatially precise accessibility logsums proved infeasible 
as the spatial lags of the independent variables introduced substantial collinearity
in the model equations. A large-sample survey of individuals in New York City,
including measured physical activities and obesity would always be preferable
to the tract-level data used in this study. An ideal survey to address the
question would incorporate both sets of questions: physical activity and health
data on one hand and park use (including which parks were used and how
frequently) on the other. As no such dataset exists to our knowledge, this
tract-level aggregate analysis with asserted and transferred utility
coefficients is the possibility that remains.

This paper applies a previously-presented but little-used accessibility
statistic that could, in theory, accommodate many attributes of the destination
parks as well as the people who might use them. As an illustration: the
park-going population could be separated into at least four delineated clusters,
each preferring different amenities of a park:
\begin{itemize}
 \item{runners and cyclists: long, interesting trail systems}
 \item{sports players: soccer fields, basketball courts, or baseball diamonds}
 \item{families with small children: water features and playgrounds}
 \item{casual users: water features, gardens, performances, etc.}
\end{itemize}
An analyst could then compute the utility-based accessibility for each cluster
with different utility values for each park's amenities, and obtain a measure of
a neighborhood's accessibility to park features that its residents most care
about. In this paper, we proceed only incrementally towards
this by adding some selected park amenities as an element of each park's
attractiveness above and beyond its size. The set of amenities we included in
the utility calculation --- and the contribution of each amenity to the overall
utility --- was dictated by the availability of data on the park amenities in New
York City and our ability to find comparable prior studies with transferrable
utility parameters. We can envision a study where mobile device data
revealing the home locations of park users would be paired with more detailed
park amenities and use data (e.g. geolocated Twitter data *a la*
@roberts2017using) to estimate the utility contribution of these features. This
could in turn provide a more nuanced understanding of the relationship between
park accessibility, use, and health outcomes.

As a travel impedance measure, we used the Euclidean distance between each tract's
population-weighted centroid and the nearest point on the edge of a park's border.
Euclidean distances have well-rehearsed limitations regarding their fidelity with
the underlying infrastructure network, etc. Network-based distances can also
suffer from challenges when applied to multimodal problems; these challenges are
exacerbated when the non-highway mode share is high, as is likely when considering
access to parks. We examined replacing the Euclidean distance with a network-based
distance; the choice of distance metric appeared inconsequential to our larger
findings in this case. We retained the Euclidean distance for computational simplicity. A
better metric of travel impedance may be a mode choice model logsum, which
weights all alternative travel alternatives against each other. We leave this as
a recommendation for future research.

We compared our utility-based accessibility to a well-constructed isochrone
that has attracted attention in the literature. That said, virtually all tracts
in New York City are within this specific isochrone. It is possible that this 
isochrone may be more discriminating of park access in other cities, or that a
different definition would yield different results in New York City. This
observation however reinforces our suggestion that a measure explicitly based in
the utility of access is warranted.

Finally, this study is primarily focused on the hypothesis that accessibility to
parks encourages physical activity, which in turn reduces obesity. There are a
multitude of other hypotheses that might be proposed and tested with the basic
methodology we have employed here, or competing explanations for the outcomes we
have observed. It is distinctly possible, for instance, that individuals who wish
to exercise regularly in parks choose to live near them. Given that the CDC models
informing the small-area obesity and physical activity estimates presumably include variables
likely to influence such preferences (income, etc.), our investigation cannot
isolate the preferences from the effect. Controlling for such a
self-selection effect would be necessary to isolate the exogenous
impacts of park access on obesity or other health outcomes. And regarding these
other variables: this study did not consider potential relationships between park
access and hospitalization rates, life expectancy, respiratory disease,
mental health, or any number of potential beneficial outcomes hypothesized
or explored in the existing literature. The COVID-19 pandemic and its associated
social distancing behaviors in many regions of the world has also drawn
attention to problems of park access, use, and equity. Exploring these
connections and their underlying mechanisms should be a priority as city
planners and urban architects attempt to improve the quality of life of urban
residents in the future.

# Conclusion

Increased physical activity and decreased obesity rates are critical measures of
improvement in public health. Although many have theorized the link between park
accessibility and these metrics, previous literature has produced mixed
findings, perhaps owing to the range of variables modeled and the coarse spatial
scale of the analyses. Using New York City as a case study, we presented a
holistic and flexible measurement for park accessibility that compares the
continuous distance to all parks in the region, weighted against the size of the
park and its other amenities, with weights determinable through revealed
preferences. In terms of physical activity, we found a positive relationship
where the least park-accessible tracts have an expected physical activity
participation rate between `r 6 * .01` and `r 6 * .3` percentage points lower than the most
accessible tracts. We also found a suggestive though not sigificant relationship
between park accessiblity and expected obesity rates *in addition to* the effect
of physical activity participation. 

In both cases a common, isochrone-based analysis estimated a statistically weak
relationship with greater uncertainty. Isochrone analyses are relatively common in
the literature, perhaps because of the widespread availability of and training
in GIS software. In spite of their widespread use, isochrones are relatively
limited in terms of both their theoretical underpinnings and their flexibility
to accommodate attributes of parks beyond their proximity. And even proximity
may not be adequately handled, as the isochrone threshold may be arbitrarily
asserted by the researcher. The model we apply in this paper extends
a more comprehensive and flexible approach
for measuring the impact of park access on health outcomes. Adopting
utility-based accessibilities of the kind used in this study will allow
researchers to encompass the full range of park amenities in their accessibility
analyses, and to separate the definition of access from the study of its effects.
This will in turn enhance the ability of planners to consider how multiple
attributes of a park --- from its location to its size to its amenities and
beyond --- benefit the health of the community the park serves.

\begin{acks}
This project was funded by the Speedwell Foundation. We are grateful to Rachel
Samuels and Neda Madi for helping to assemble the data.
\end{acks}



# References {#references .unnumbered}